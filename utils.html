<!DOCTYPE html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>

<style type="text/css">
.my-1 { margin-top: 1rem;margin-bottom: 1rem }
</style>

<body>
<div ng-app="myApp" ng-controller="myCtrl"> 
 
	<p>Input something in [A] [B] [C]:</p>

	<textarea ng-model="inputA" rows="25" cols="40" ng-trim="false"></textarea>
	<textarea ng-model="inputB" rows="25" cols="40" ng-trim="false"></textarea>
	<textarea ng-model="inputC" rows="25" cols="40" ng-trim="false"></textarea>

    <div class="my-1">
        Replace (regex) : <input type="text" ng-model="regexA" placeholder="From"> => <input type="text" ng-model="replaceBy" placeholder="To" ng-trim="false">
        <button ng-click="replaceRg()">B=A.Replace('From', 'To')</button>
        <button ng-click="synonyms()">B=A.synonyms</button>
        <button ng-click="boDauTiengViet()">A(ư á)->u a</button>
        <button ng-click="add_underscore()">a b->a_b</button>
        <button ng-click="add_underscore(false)">a_b->a b</button>
    </div>
	
	
	<button ng-click="combineA_B()">C=A+B</button>

    <div class="my-1">
       <label for="cars">Box </label>
       <select ng-model="selectedBox">
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
        </select>

        <button ng-click="boxAppendBr()">Append 'br' tag</button>     
    </div>

	<span ng-repeat="x in records">{{x}}&nbsp;&nbsp;&nbsp;</ul>

	</div> <!-- controller -->
</body>
</html>

<script>
var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope) 
{
    const KBr = '<br>\\\n'
    $scope.selectedBox = "C"
	 $scope.boxAppendBr = function()
    {
    	let result = ''

        let inputBox = $scope.inputC
        if ($scope.selectedBox=='A') inputBox = $scope.inputA
        else if ($scope.selectedBox=='B') inputBox = $scope.inputB

        if (!inputBox) return
        else inputBox = inputBox.replace(/(<br>\\)/gm, '').trim()

    	let splBox = inputBox.split('\n')
    	for (var i = 0; i < splBox.length; i++) 
    	{
    		const ele = splBox[i]
    		result += ele + KBr
    	}
        if ($scope.selectedBox==='A')  $scope.inputA = result
        else if ($scope.selectedBox==='B')  $scope.inputB = result
    	else $scope.inputC = result

    	saveAll() 
    }

    $scope.combineA_B = function()
    {
    	let resultA_B = ''
    	let splA = $scope.inputA.split('\n')
    	let splB = $scope.inputB.split('\n')
    	for (var i = 0; i < splA.length; i++) 
    	{
    		const eleA = splA[i]
    		let eleB = splB[i] || ''
    		resultA_B += eleA + eleB + '\n'
    	}
    	$scope.inputC = resultA_B

    	saveAll()
    }

    $scope.replaceRg = function()
    {   
    	let rgA =  new RegExp ($scope.regexA, 'gi')
    	let reBy = $scope.replaceBy || ''

    	$scope.inputB = $scope.inputA.replace(rgA, reBy)

    	saveAll()
    }

    $scope.add_underscore = function(add=true)
    {   
        let input = ''
        if (add)
        {
            input = $scope.inputA.replace(/[\,\-&\.]/gi, ' ').replace(/\s+/gi, '_')
        }
        else
            input = $scope.inputA.replace(/[_]/gi, ' ')

    	$scope.inputB = input
    	saveAll()
        copyToClipboard(input)
    }

    $scope.boDauTiengViet = function()
    {
    	$scope.inputB = removeAccents($scope.inputA)
    	saveAll()
    }

    $scope.synonyms = function()
    {   
        let splA = $scope.inputA.split(' ')
        let r = '{\n'
        let _words = 'words: "'
        for (var i = 0; i < splA.length; i++) {
           var ele = splA[i]
           _words += ele
           if ( i < splA.length - 1 ) _words += ' | '
        }
        r += _words + ' "\n' + ', type:""' + '\n' + ', mean: "" ' + '\n}'

        $scope.inputB = r
        saveAll()
    }



 $scope.records = [
        "\\d",
        "adj\\.",
        "n\\.",
        "v\\.",
    ]

// Copies text to clipboard
function copyToClipboard(text) {
  navigator.clipboard.writeText(text)
    .then(() => {
      console.log('Copied to clipboard successfully!');
    })
    .catch(err => {
      console.error('Failed to copy: ', err);
    });
}

function saveDB(key,val )
{
	localStorage.setItem(key, val);
}

function removeAccents(str) {
  var AccentsMap = [
    "aàảãáạăằẳẵắặâầẩẫấậ",
    "AÀẢÃÁẠĂẰẲẴẮẶÂẦẨẪẤẬ",
    "dđ", "DĐ",
    "eèẻẽéẹêềểễếệ",
    "EÈẺẼÉẸÊỀỂỄẾỆ",
    "iìỉĩíị",
    "IÌỈĨÍỊ",
    "oòỏõóọôồổỗốộơờởỡớợ",
    "OÒỎÕÓỌÔỒỔỖỐỘƠỜỞỠỚỢ",
    "uùủũúụưừửữứự",
    "UÙỦŨÚỤƯỪỬỮỨỰ",
    "yỳỷỹýỵ",
    "YỲỶỸÝỴ"    
  ];
  for (var i=0; i<AccentsMap.length; i++) {
    var re = new RegExp('[' + AccentsMap[i].substr(1) + ']', 'g');
    var char = AccentsMap[i][0];
    str = str.replace(re, char);
  }
  return str;
}


function loadData()
{
    if (localStorage.hasOwnProperty('inputA')) 
        $scope.inputA = localStorage['inputA'].trim()
    if (localStorage.hasOwnProperty('inputB')) 
        $scope.inputB = localStorage['inputB'].trim()
    if (localStorage.hasOwnProperty('inputC')) 
        $scope.inputC = localStorage['inputC'].trim()
}

function saveAll()
{
	saveDB('inputA', $scope.inputA)
    saveDB('inputB', $scope.inputB)
    saveDB('inputC', $scope.inputC)
}
function saveC() 
{
	saveDB('inputC', $scope.inputC)
}

loadData();

});
</script>